(()=>{let e=!1;const t={initEvent(){if(!e){let i=$("body");i.on("click","figure>figcaption .fa-angle-down",function(){let i=$(this);i.is(".close")?($(i.attr("data-code")).parent().slideDown(200),i.removeClass("close")):($(i.attr("data-code")).parent().slideUp(200),i.addClass("close"))}),i.on("click","figure > pre > .expand-done",function(){Utils.foldBlock($(this).parent().parent())}),i.on("click",".gallery-item .expand-done",function(i){i.stopPropagation(),Utils.foldBlock($(this).parent())}),Utils.initLikeEvent(".admire .agree.like","posts",i=>i.find("span").find("span")),e=!0}},initCodeBlock(){const i=$("*:not(figure) > pre > code");0!==i.length&&i.each(function(i){const e=$(this).parent();let t=$(this).attr("class"),n="",a=!1;if(null!=t){let i=t.indexOf("|"),e=t.indexOf("<");n=-1!==i||-1!==e?((-1===i||-1!==e&&e<i)&&(a=!0,i=e),$(this).attr("class",t.substring(0,i)),i===t.length-1?t.substring(9,i):t.substring(i+1)):t.substring(9)}let o=$(this).text().split("\n").length-1||1,l=String(o).length,s=(1===l&&(l=2),"");for(var d=0;d<o;d++)s+=`<li>${String(d+1).padStart(l,0)}</li>`;let r="codeBlock"+i,c="";a&&(c=" close",$(this).hide());i=`<div><i class="fa fa-angle-down${c}" data-code='#${r}'></i><i class="fa fa-clone btn-clipboard" title="复制代码" data-clipboard-target='#${r}'></i></div>`;$(this).attr("id",r),e.prepend(`<ul>${s}</ul>`),o>DreamConfig.code_fold_line?e.wrap('<figure class="fold hljs"></figure>').append('<div class="expand-done"><i class="fa fa-angle-double-up"></i></div>'):e.wrap('<figure class="hljs"></figure>'),e.parent().prepend(`<figcaption>${n}${i}</figcaption>`)})},initLiterature(){$(".literature-content>p:not([class])").each(function(){0===$(this).children(":not(code,a,strong,em,ins,s,br,span.pwd)").length&&$(this).addClass("note")})},initLike(){Utils.initLikeButton(".admire .agree.like","posts")},initHighlighting(){hljs.initHighlightingOnLoad()},initShare(){if(window.DShare){let i=$(".cover-image").css("background-image");i=i&&i.substring(5,i.length-2),DShare.create(".dshare",{image:i,imageSelector:".main-content"})}},initClipboard(){window.clipboard||(window.clipboard=new ClipboardJS(".btn-clipboard"),clipboard.on("error",function(i){i.clearSelection(),Qmsg.error("您的浏览器不支持复制")}),clipboard.on("success",function(){Qmsg.success("复制成功")}))},foldImage(){if(DreamConfig.img_fold_height){const i=$(".article .gallery-item>[data-fancybox]>img");i.parent().addClass("fold"),i.each(function(){const i=$(this).parent();this.complete?this.scrollHeight>=DreamConfig.img_fold_height?i.append('<div class="expand-done"><i class="fa fa-angle-double-up"></i></div>'):i.removeClass("fold"):this.onload=function(){this.scrollHeight>=DreamConfig.img_fold_height?i.append('<div class="expand-done"><i class="fa fa-angle-double-up"></i></div>'):i.removeClass("fold")}})}}};window.postPjax=function(e){0!==$(".main-content").length&&Object.keys(t).forEach(i=>window.pjaxSerialNumber===e&&t[i]())};{const n=["initEvent","initCodeBlock","initLike","foldImage"];Object.keys(t).forEach(i=>!window.pjaxSerialNumber&&n.includes(i)&&t[i]()),document.addEventListener("DOMContentLoaded",function(){Object.keys(t).forEach(i=>!window.pjaxSerialNumber&&!n.includes(i)&&t[i]())})}})();